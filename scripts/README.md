# TS-CVA Training Scripts

TS-CVA ëª¨ë¸ì˜ ì„¸ ê°€ì§€ í•™ìŠµ ëª¨ë“œë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

## ğŸ“‹ í•™ìŠµ ëª¨ë“œ ë¹„êµ

| ëª¨ë“œ | ìŠ¤í¬ë¦½íŠ¸ | ì„¤ëª… |
|------|----------|------|
| **TS2Vec Only** | `train_ts2vec_only.ps1` | ìˆœìˆ˜ ì‹œê³„ì—´ ë°ì´í„°ë§Œ ì‚¬ìš© (Cross-Modal âŒ) |
| **Cross-Modal** | `train_crossmodal.ps1` | ì‹œê³„ì—´ + LLM í”„ë¡¬í”„íŠ¸ ì„ë² ë”© (Cross-Modal âœ…) |
| **With News** | `train_with_news.ps1` | ì‹œê³„ì—´ + ë‰´ìŠ¤ ê¸°ë°˜ LLM ì„ë² ë”© (ë‰´ìŠ¤ âœ…) |

## ğŸš€ ì‚¬ìš©ë²•

### ê°œë³„ ì‹¤í–‰ (PowerShell)
```powershell
# 1. TS2Vec Only
.\scripts\train_ts2vec_only.ps1

# 2. Cross-Modal
.\scripts\train_crossmodal.ps1

# 3. With News
.\scripts\train_with_news.ps1
```

### ì „ì²´ ì‹¤í—˜ í•œë²ˆì— ì‹¤í–‰
```powershell
# Windows PowerShell
.\scripts\run_all_experiments.ps1 -Dataset tech -Epochs 200 -GPU 0

# Linux/Mac
bash scripts/run_all_experiments.sh tech 200 0
```

## âš™ï¸ ì„¤ì • ë³€ê²½

ê° ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì—ì„œ ë‹¤ìŒ ë³€ìˆ˜ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

```powershell
$DATASET = "tech"           # tech ë˜ëŠ” indices
$RUN_NAME = "ts2vec_only"   # ì‹¤í–‰ ì´ë¦„
$EPOCHS = 200               # í•™ìŠµ ì—í­ ìˆ˜
$BATCH_SIZE = 32            # ë°°ì¹˜ í¬ê¸°
$LR = 0.001                 # í•™ìŠµë¥ 
$REPR_DIMS = 320            # ì„ë² ë”© ì°¨ì›
$GPU = 0                    # GPU ë²ˆí˜¸
```

## ğŸ“Š ì¶œë ¥ ê²°ê³¼

í•™ìŠµ ê²°ê³¼ëŠ” `training/` ë””ë ‰í† ë¦¬ì— ì €ì¥ë©ë‹ˆë‹¤:

```
training/
â”œâ”€â”€ tech__ts2vec_only_200ep_20231203_120000/
â”‚   â”œâ”€â”€ model.pkl              # í•™ìŠµëœ ëª¨ë¸
â”‚   â”œâ”€â”€ model_best.pkl         # ìµœì  ëª¨ë¸
â”‚   â”œâ”€â”€ forecast_head.pt       # ì˜ˆì¸¡ í—¤ë“œ
â”‚   â”œâ”€â”€ summary.txt            # ì„±ëŠ¥ ìš”ì•½
â”‚   â””â”€â”€ predictions.npz        # ì˜ˆì¸¡ ê²°ê³¼
â”œâ”€â”€ tech__crossmodal_200ep_20231203_130000/
â”‚   â””â”€â”€ ...
â””â”€â”€ tech__crossmodal_news_200ep_20231203_140000/
    â””â”€â”€ ...
```

## ğŸ“ˆ ê²°ê³¼ ë¹„êµ

`summary.txt` íŒŒì¼ì—ì„œ ë‹¤ìŒ ì§€í‘œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- **RMSE**: Root Mean Square Error
- **MAE**: Mean Absolute Error  
- **MAPE**: Mean Absolute Percentage Error
- **Direction Accuracy**: ë°©í–¥ ì˜ˆì¸¡ ì •í™•ë„ (ìƒìŠ¹/í•˜ë½)

## âš ï¸ ì‚¬ì „ ìš”êµ¬ì‚¬í•­

### 1. ë°ì´í„° ì¤€ë¹„
```powershell
# Yahoo Finance ë°ì´í„° ë‹¤ìš´ë¡œë“œ
python datasets/download_yahoo_finance.py --preset tech --create-sequences
```

### 2. LLM ì„ë² ë”© ìƒì„± (Cross-Modalìš©)
```powershell
python storage/store_emb_yahoo.py --dataset tech
```

### 3. ë‰´ìŠ¤ ë°ì´í„° ì¤€ë¹„ (With Newsìš©)
```powershell
# ë‰´ìŠ¤ í¬ë¡¤ë§
python datasets/crawl_yahoo_news.py --dataset tech

# ë‰´ìŠ¤ ì„ë² ë”© ìƒì„±
python storage/gen_news_embeddings.py --dataset tech
```

## ğŸ”¬ ì‹¤í—˜ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TS-CVA Architecture                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Time Series â”‚    â”‚   TS2Vec     â”‚    â”‚  Time Series â”‚  â”‚
â”‚  â”‚    Input     â”‚â”€â”€â”€â–¶â”‚   Encoder    â”‚â”€â”€â”€â–¶â”‚    Repr      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚          â”‚
â”‚                      TS2Vec Only: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â–¶   â”‚
â”‚                                                  â”‚          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â–¼          â”‚
â”‚  â”‚   Prompt /   â”‚    â”‚   Prompt     â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚    News      â”‚â”€â”€â”€â–¶â”‚   Encoder    â”‚â”€â”€â”€â–¶â”‚ Cross-Modal  â”‚  â”‚
â”‚  â”‚  Embeddings  â”‚    â”‚              â”‚    â”‚  Attention   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                  â”‚          â”‚
â”‚                      Cross-Modal: â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â–¶   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
